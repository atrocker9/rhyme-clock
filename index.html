<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rhyming Clock</title>
  <style>
    :root{
      --bg: #0b0f14;
      --metal-1:#2b313a;
      --metal-2:#151a21;
      --edge:#0a0d12;
      --highlight: rgba(255,255,255,.10);
      --shadow: rgba(0,0,0,.55);

      --glass: rgba(10, 22, 28, .55);
      --glass2: rgba(255,255,255,.06);
      --glow: rgba(120, 240, 255, .12);

      --text: rgba(232, 248, 255, .92);
      --text-dim: rgba(232, 248, 255, .62);

      --accent: rgba(120, 240, 255, .9);
      --accent-dim: rgba(120, 240, 255, .35);

      --radius: 22px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }

    html,body{
      height:100%;
      margin:0;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(120,240,255,.08), transparent 60%),
        radial-gradient(900px 700px at 90% 40%, rgba(255,255,255,.05), transparent 55%),
        linear-gradient(180deg, #070a0f, #0b0f14);
      color:var(--text);
      font-family: var(--sans);
    }

    /* Centered single widget (Notion embed friendly) */
    .wrap{
      min-height:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      box-sizing:border-box;
    }

    /* Skeuomorphic “clock” chassis */
    .chassis{
      width:min(780px, 96vw);
      aspect-ratio: 16/9;
      border-radius: calc(var(--radius) + 10px);
      background:
        linear-gradient(145deg, var(--metal-1), var(--metal-2));
      box-shadow:
        0 30px 80px var(--shadow),
        inset 0 1px 0 rgba(255,255,255,.10),
        inset 0 -1px 0 rgba(0,0,0,.55);
      position:relative;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.06);
    }

    /* Precision edges & subtle “Rams-like” geometry */
    .chassis::before{
      content:"";
      position:absolute;
      inset:10px;
      border-radius: var(--radius);
      background:
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.08));
      border: 1px solid rgba(255,255,255,.05);
      box-shadow:
        inset 0 10px 30px rgba(0,0,0,.35),
        inset 0 1px 0 rgba(255,255,255,.08);
      pointer-events:none;
    }

    /* “Screws” */
    .screw{
      width:10px;height:10px;border-radius:50%;
      position:absolute;
      background:
        radial-gradient(circle at 30% 30%, rgba(255,255,255,.22), rgba(255,255,255,.04) 35%, rgba(0,0,0,.35) 70%),
        linear-gradient(135deg, rgba(255,255,255,.06), rgba(0,0,0,.25));
      border:1px solid rgba(255,255,255,.06);
      box-shadow: inset 0 1px 2px rgba(0,0,0,.5);
      opacity:.9;
    }
    .s1{top:14px;left:14px}
    .s2{top:14px;right:14px}
    .s3{bottom:14px;left:14px}
    .s4{bottom:14px;right:14px}

    /* Inner layout */
    .inner{
      position:absolute;
      inset:22px;
      border-radius: var(--radius);
      display:grid;
      grid-template-rows: 1fr auto;
      gap:14px;
    }

    /* Glass display window (only poem shows inside) */
    .display{
      border-radius: 18px;
      background:
        linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.22)),
        radial-gradient(700px 280px at 30% 0%, rgba(120,240,255,.10), transparent 60%),
        linear-gradient(180deg, var(--glass), rgba(0,0,0,.38));
      border: 1px solid rgba(120,240,255,.10);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,.08),
        inset 0 -12px 24px rgba(0,0,0,.35),
        0 18px 35px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }

    /* Glass reflections */
    .display::before{
      content:"";
      position:absolute;
      inset:-40px -60px auto -60px;
      height:120px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.10), transparent);
      transform: rotate(-12deg);
      opacity:.45;
      filter: blur(.2px);
      pointer-events:none;
    }
    .display::after{
      content:"";
      position:absolute;
      inset:auto -80px -60px -80px;
      height:160px;
      background: radial-gradient(circle at 50% 50%, rgba(120,240,255,.10), transparent 70%);
      opacity:.7;
      pointer-events:none;
    }

    /* The poem itself (typewriter) */
    .poem{
      width:100%;
      max-width: 42ch;
      font-family: var(--mono);
      font-size: clamp(16px, 2.2vw, 22px);
      line-height: 1.55;
      letter-spacing: .2px;
      color: var(--text);
      text-shadow: 0 0 18px rgba(120,240,255,.08);
      white-space: pre-wrap;
      margin:0;
      position:relative;
      z-index:2;
    }

    .cursor{
      display:inline-block;
      width: .65ch;
      margin-left: .15ch;
      background: var(--accent);
      box-shadow: 0 0 18px var(--accent-dim);
      transform: translateY(2px);
      animation: blink 1s steps(1,end) infinite;
    }
    @keyframes blink { 50% { opacity: 0; } }

    /* Lower “controls” strip (purely aesthetic) */
    .controls{
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(0,0,0,.20));
      border:1px solid rgba(255,255,255,.06);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding: 12px 14px;
      gap:12px;
    }

    .brand{
      font-family: var(--sans);
      font-size: 12px;
      letter-spacing: .22em;
      text-transform: uppercase;
      color: rgba(232,248,255,.55);
      user-select:none;
    }

    .dots{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .dot{
      width:10px;height:10px;border-radius:999px;
      background: rgba(120,240,255,.12);
      border:1px solid rgba(120,240,255,.18);
      box-shadow: inset 0 1px 0 rgba(255,255,255,.07);
    }
    .dot.on{
      background: rgba(120,240,255,.55);
      box-shadow: 0 0 18px rgba(120,240,255,.20), inset 0 1px 0 rgba(255,255,255,.10);
    }

    /* Notion embeds sometimes add a white background via iframe; this helps */
    .safe-bg{
      background: transparent;
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .cursor{ animation:none; }
    }
  </style>
</head>
<body class="safe-bg">
  <div class="wrap">
    <div class="chassis" role="img" aria-label="A minimalist rhyming clock with a glass text display.">
      <div class="screw s1"></div><div class="screw s2"></div><div class="screw s3"></div><div class="screw s4"></div>

      <div class="inner">
        <div class="display">
          <p id="poem" class="poem"></p>
        </div>

        <div class="controls" aria-hidden="true">
          <div class="brand">RHYME•CLOCK</div>
          <div class="dots">
            <div class="dot on"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
(() => {
  // --- Rhyming engine: deterministic per minute, so it changes exactly once per minute ---
  // We build a couplet (two lines) with a shared rhyme ending.
  const RHYMES = [
    { end: "light", a: ["night","sight","flight","bright","right"], b:["ignite","insight","midnight","moonlight","starlight"] },
    { end: "time",  a: ["chime","climb","rhyme","prime","sublime"], b:["meantime","springtime","shoreline","daytime","lifetime"] },
    { end: "flow",  a: ["glow","slow","go","know","snow"], b:["afterglow","undertow","tempo","echo","halo"] },
    { end: "steel", a: ["feel","real","wheel","keel","seal"], b:["hand-feel","surreal","ring-seal","veer","ideal"] },
    { end: "calm",  a: ["palm","psalm","qualm","balm","alm"], b:["home-spun","soft-sun","low-hum","still-some","near-sum"] },
    { end: "clear", a: ["near","here","steer","year","peer"], b:["atmosphere","volunteer","engineer","frontier","sincere"] },
    { end: "arc",   a: ["mark","spark","dark","lark","stark"], b:["aftershock","overclock","benchmark","daymark","wildheart"] },
    { end: "tone",  a: ["stone","known","grown","shown","alone"], b:["undertone","monotone","backbone","high-tone","home zone"] },
    { end: "fine",  a: ["line","sign","shine","design","align"], b:["by design","clean line","true sign","bright shine","in time"] },
    { end: "more",  a: ["core","shore","floor","door","restore"], b:["therefore","evermore","hardcore","in store","to the fore"] }
  ];

  const OPENERS = [
    "Minute {m}: a small machine keeps faith,",
    "At {h}:{mm}, the quiet gears agree,",
    "This minute turns like brushed aluminum,",
    "A clean line holds the day in place,",
    "Time clicks; the room becomes a circuit,",
    "Another minute—precision without noise,"
  ];

  const SECOND_LINES = [
    "and leaves a {a} {end} behind the {b}.",
    "so let the {a} {end} arrive, and {b} feel {end}.",
    "where {a} {end} meets {b}, the edges stay {end}.",
    "as {a} {end} and {b} keep everything {end}.",
    "with {a} {end} in the frame, and {b} held {end}.",
    "while {a} {end} and {b} make the moment {end}."
  ];

  // Tiny pseudo-random seeded by minute-key so output is stable during that minute.
  function mulberry32(seed){
    return function(){
      let t = seed += 0x6D2B79F5;
      t = Math.imul(t ^ (t >>> 15), t | 1);
      t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
      return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    }
  }
  function pick(rng, arr){ return arr[Math.floor(rng() * arr.length)]; }

  function minuteKey(d){
    // Key changes once per minute (local time).
    return d.getFullYear()*100000000 + (d.getMonth()+1)*1000000 + d.getDate()*10000 + d.getHours()*100 + d.getMinutes();
  }

  function pad2(n){ return String(n).padStart(2,"0"); }

  function buildPoem(d){
    const key = minuteKey(d);
    const rng = mulberry32(key);

    const h = d.getHours();
    const m = d.getMinutes();
    const hour12 = ((h + 11) % 12) + 1;

    const rhyme = pick(rng, RHYMES);
    const a = pick(rng, rhyme.a);
    const b = pick(rng, rhyme.b);
    const opener = pick(rng, OPENERS);
    const line2tpl = pick(rng, SECOND_LINES);

    const line1 = opener
      .replace("{m}", String(m))
      .replace("{h}", String(hour12))
      .replace("{mm}", pad2(m));

    const line2 = line2tpl
      .replace("{a}", a)
      .replace("{b}", b)
      .replaceAll("{end}", rhyme.end);

    return `${line1}\n${line2}`;
  }

  // --- Typewriter ---
  const el = document.getElementById("poem");
  let typing = null;
  let lastKey = null;

  function typeIn(text){
    if (typing) cancelAnimationFrame(typing);
    el.textContent = ""; // ensures "only poem" is shown
    const cursor = document.createElement("span");
    cursor.className = "cursor";
    cursor.textContent = " ";
    el.appendChild(cursor);

    let i = 0;
    const speedBase = 12; // ms-ish feel (we'll use rAF + time)
    let lastTs = 0;

    function step(ts){
      if (!lastTs) lastTs = ts;
      const dt = ts - lastTs;

      // Add multiple chars if the frame is late; still feels smooth.
      const charsToAdd = Math.max(1, Math.floor(dt / speedBase));
      lastTs = ts;

      for (let k=0; k<charsToAdd && i<text.length; k++){
        cursor.before(document.createTextNode(text[i]));
        i++;
      }

      if (i < text.length){
        typing = requestAnimationFrame(step);
      }
    }
    typing = requestAnimationFrame(step);
  }

  function updateIfNeeded(){
    const now = new Date();
    const key = minuteKey(now);
    if (key !== lastKey){
      lastKey = key;
      typeIn(buildPoem(now));
    }
  }

  // Start immediately
  updateIfNeeded();

  // Check a few times per minute so we hit the boundary reliably.
  // (Notion iframes can throttle; this is tolerant.)
  setInterval(updateIfNeeded, 1500);
})();
</script>
</body>
</html>
